package com.kisman.cc.module.exploit;

import com.kisman.cc.Kisman;
import com.kisman.cc.event.Event;
import com.kisman.cc.event.events.DestroyBlockEvent;
import com.kisman.cc.module.Category;
import com.kisman.cc.module.Module;
import com.kisman.cc.setting.Setting;
import me.zero.alpine.listener.EventHandler;
import me.zero.alpine.listener.Listener;

public class NoGlitchBlocks extends Module {
    public final Setting place = new Setting("Place", this, true);
    public final Setting break_ = new Setting("Break", this, true);
    public final Setting ground = new Setting("Ground", this, false);

    public static NoGlitchBlocks instance;

    public NoGlitchBlocks() {
        super("NoGlitchBlocks", Category.EXPLOIT);

        instance = this;

        register(place);
        register(break_);
        register(ground);
    }

    public void onEnable() {
        Kisman.EVENT_BUS.subscribe(destroy);
    }

    public void onDisable() {
        Kisman.EVENT_BUS.unsubscribe(destroy);
    }

    @EventHandler
    private final Listener<DestroyBlockEvent> destroy = new Listener<>(event -> {
        if(break_.getValBoolean() && event.getEra().equals(Event.Era.PRE)) event.cancel();
    });

    public boolean noPlace(){
        return isToggled() && place.getValBoolean() && (ground.getValBoolean() || mc.player.onGround);
    }
}
