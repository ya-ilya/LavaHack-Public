package com.kisman.cc.module.exploit;

import com.kisman.cc.event.events.PacketEvent;
import com.kisman.cc.module.Category;
import com.kisman.cc.module.Module;
import com.kisman.cc.setting.Setting;
import me.zero.alpine.listener.EventHandler;
import me.zero.alpine.listener.Listener;
import net.minecraft.network.play.client.CPacketAnimation;

public class NoSwing extends Module {
    private final Setting mode = new Setting("Mode", this, Mode.Server);

    public NoSwing() {
        super("NoSwing", "", Category.EXPLOIT);

        register(mode);
    }

    public void onEnable() {
        
    }

    public void onDisable() {
        
    }

    public void update() {
        if(mc.player == null || mc.world == null) return;

        if(mode.getValString().equals(Mode.Client.name())) {
            mc.player.isSwingInProgress = false;
            mc.player.swingProgressInt = 0;
            mc.player.swingProgress = 0;
            mc.player.prevSwingProgress = 0;
        }
    }

    @EventHandler
    @SuppressWarnings("unused")
    private final Listener<PacketEvent.Send> packetSendListener = listener(event -> {
        if(event.getPacket() instanceof CPacketAnimation && mode.getValString().equals(Mode.Server.name())) {
            event.cancel();
        }
    });

    public enum Mode {
        Client,
        Server
    }
}
