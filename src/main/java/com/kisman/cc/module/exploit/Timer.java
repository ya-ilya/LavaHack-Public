package com.kisman.cc.module.exploit;

import com.kisman.cc.Kisman;
import com.kisman.cc.event.events.PlayerUpdateEvent;
import com.kisman.cc.module.Category;
import com.kisman.cc.module.Module;
import com.kisman.cc.setting.Setting;
import me.zero.alpine.listener.EventHandler;
import me.zero.alpine.listener.Listener;

public class Timer extends Module {
    private final Setting speed = new Setting("Ticks", this, 4, 0.1, 10, false);

    public Timer() {
        super("Timer", "", Category.EXPLOIT);

        register(speed);
    }

    public void onEnable() {
        Kisman.EVENT_BUS.subscribe(playerUpdateListener);
    }

    public void onDisable() {
        Kisman.EVENT_BUS.unsubscribe(playerUpdateListener);

        mc.timer.tickLength = 50;
    }

    @EventHandler
    private final Listener<PlayerUpdateEvent> playerUpdateListener = new Listener<>(event -> mc.timer.tickLength = 50 / getSpeed());

    private float getSpeed() {return Math.max((float) speed.getValDouble(), 0.1f);}
}
